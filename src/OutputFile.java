/**

oxdoc (c) Copyright 2005-2010 by Y. Zwols

This library is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 2.1 of the License, or (at your option) any later version.

This library is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public
License along with this library; if not, write to the Free Software
Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA

**/

import java.io.*;
import java.text.*;


public class OutputFile {
   Writer output = null;
   String _fileName;
   boolean isHtml = false;
   public OxDoc oxdoc;

   // create a blank file
   public OutputFile(String fileName, OxDoc oxdoc) throws IOException {
      File aFile = new File(oxdoc.fileManager.outputFile(fileName).trim());
      aFile.getParentFile().mkdirs();
      output = new BufferedWriter(new FileWriter(aFile));
      _fileName = fileName;
      this.oxdoc = oxdoc;
   }

   // create an HTML file
   public OutputFile(String fileName, String title, int iconType, OxDoc oxdoc) throws IOException {
      this(fileName, oxdoc);
      isHtml = true;
      writeDocHeader(title, iconType);
   }

   public void close() throws IOException {
      if (isHtml)
         writeDocFooter();
      output.close();
   }

   public void writeChar(int ch) throws IOException {
      output.write(ch);
   }

   public void write(Object s) throws IOException {
      output.write(s.toString());
   }

   public void writeln(Object s) throws IOException {
      output.write(s.toString() + "\n");
   }

   private void writeDocHeader(String title, int iconType) throws IOException {
      writeln("<?xml version=\"1.0\" encoding=\"UTF-8\"?>");
      writeln("<!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Strict//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd\">");
      writeln("<html xmlns=\"http://www.w3.org/1999/xhtml\" xml:lang=\"en\">");
      writeln("<head>");
      writeln("<link rel=\"stylesheet\" type=\"text/css\" href=\"oxdoc.css\">");
      writeln(oxdoc.config.MathProcessor.ExtraHeader());
      writeln("<title>" + title + " - " + oxdoc.config.WindowTitle + "</title>");
      writeln("</head>");
      writeln("<body>");
      writeln("<div class=\"header\">");
      write  ("[ ");
      if (oxdoc.config.UpLevel)
         writeln(oxdoc.fileManager.smallIcon(FileManager.UPLEVEL) + "<a href=\"..\\default.html\">Up Level</a> |"); /** Added by CF **/
     
      writeln(oxdoc.fileManager.smallIcon(FileManager.PROJECT) + "<a href=\"default.html\">Project home</a>");
      writeln(" | " + oxdoc.fileManager.smallIcon(FileManager.INDEX) + "<a href=\"index.html\">Index</a>");
      writeln(" | " + oxdoc.fileManager.smallIcon(FileManager.HIERARCHY) + "<a href=\"hierarchy.html\">Class hierarchy</a> ]</div>");
      writeln("<h1>" + oxdoc.fileManager.largeIcon(iconType) + title + "</h1>");
   }

   private void writeDocFooter() throws IOException {
      Object[] args = { OxDoc.ProductName, OxDoc.Version, OxDoc.Url };


      writeln("<div class=\"footer\">");
      writeln(MessageFormat.format("Generated by <a href=\"{2}\">{0} {1}</a> &copy Copyright 2005-2012 by Y. Zwols<br>", args));
      writeln(oxdoc.config.MathProcessor.ExtraFooter());
      writeln("</div>");
   }
}
